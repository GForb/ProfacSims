---
title: "Prediction with new data for intercept - Supplementary material part 2"
format: 
  html:
    number-sections: True
    fig-height: 10
    fig-width: 8
editor: visual
execute: 
  echo: FALSE

---

```{r include = FALSE}
library(tidyverse)
library(ggplot2)
library(DBI)
library(RSQLite)
library(here)
library(glue)

# Loading files:
sim_name <- "240211_cluster-x"
results_folder <- here("Results", "Database-extracts", sim_name)



```

## Calibration in the large
```{R}
calib_itl <- readRDS(file = here(results_folder, "calib_itl.RDS")) |> 
  filter(model != "Random intercept - ML", model != "Hausman - centred") |> 
  ProfacSims:::correct_model_spelling()

```

### Estimates
```{r calib_itl_est}
calib_itl$plot_value = calib_itl$est
for(my_n_studies in c(4, 8, 16, 32, 64)){
  for(myICC in c(0.05, 0.2)){
    plot_data <- calib_itl |> filter(n_studies ==my_n_studies, myICC ==myICC) 
      plot <- plot_data |> 
        ProfacSims:::box_plot_cluster_x() + #
        ylab(glue("Calibration In the Large")) +
        scale_y_continuous(limits = c(-0.5,0.5))
      
        print(plot)
  }
}
```


